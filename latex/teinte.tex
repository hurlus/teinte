%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% <TEI> generic (LaTeX names generated by Teinte) %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This template is inserted in a specific design

\makeatletter % <@@@

\usepackage{blindtext} % generate text for testing
\usepackage{contour} % rounding words
\usepackage[nodayofweek]{datetime}
\usepackage{DejaVuSans} % font for symbols
\usepackage{enumitem} % <list>
\usepackage{etoolbox} % patch commands
\usepackage{fancyvrb}
\usepackage{fancyhdr}
\usepackage{fontspec} % XeLaTeX mandatory for fonts
\usepackage{footnote} % hack to collect footnotes in minipage etc.
\usepackage{framed} % bordering correct with footnote hack
\usepackage{graphicx}
\usepackage{lettrine} % drop caps
\usepackage{lipsum} % generate text for testing
\usepackage[framemethod=tikz,]{mdframed} % maybe used for frame with footnotes inside
\usepackage{polyglossia} % non-break space french punct, bug Warning: "Failed to patch part"
\usepackage{ragged2e}
\usepackage{tabularx} % <table>
\usepackage[explicit]{titlesec} % NO implicit !, wear titles
\usepackage{tikz} % ornaments
\usepackage{tocloft}
\usepackage[fit]{truncate} % used im runing titles
\usepackage{unicode-math}
\usepackage{verse} % <l>
\usepackage{xcolor} % named colors
\usepackage{xparse} % recommanded
\usepackage{hyperref} % supposed to be the last one, :o) except for the one to follow
% TOTEST
% \usepackage{hypcap} % links in caption ?
% \usepackage{marginnote}
% TESTED
% \usepackage{background} % doesn’t work with xetek
% \usepackage[color, leftbars]{changebar} % 2 cols doc, impossible to keep bar left
% \usepackage[utf8x]{inputenc} % inputenc package ignored with utf8 based engines
% \usepackage{firamath} % unavailable in Ubuntu 21-04
% \usepackage{flushend} % bad for last notes, supposed flush end of columns
% \usepackage{multicol} % not compatible with too much packages (longtable, framed, memoir…)
% \usepackage{sectsty} % \chapterfont OBSOLETE
% \usepackage[breakable]{tcolorbox} % text styling gone, footnote hack not kept with breakable


\defaultfontfeatures{
  % Mapping=tex-text, % no effect seen
  Scale=MatchLowercase,
  Ligatures={TeX,Common},
}

% Metadata inserted by a program, from the TEI source, for title page and runing heads
%meta%


% If things have not been defined before
\newcommand{\colorprovide}[2]{\@ifundefinedcolor{#1}{\colorlet{#1}{#2}}{}}
\colorprovide{rubric}{red}
\colorprovide{silver}{Gray}
\@ifundefined{syms}{\newfontfamily\syms{DejaVu Sans}}{}
\newif\ifdev
\@ifundefined{elbibl}{% No meta defined, maybe dev mode
  \newcommand{\elbibl}{Titre court ?}
  \newcommand{\elbook}{Titre du livre source ?}
  \newcommand{\elabstract}{Résumé\par}
  \newcommand{\elurl}{http://oeuvres.github.io/elbook/2}
  \author{Éric Lœchien}
  \title{Un titre de test assez long pour vérifier le comportement d’une maquette}
  \date{1566}
  \devtrue
}{}
\let\eltitle\@title
\let\elauthor\@author
\let\eldate\@date

\@ifundefined{\columnseprulecolor}{
  \patchcmd\@outputdblcol{% find
    \normalcolor\vrule
  }{% and replace by
    \columnseprulecolor\vrule
  }{% success
  }{% failure
    \@latex@warning{Patching \string\@outputdblcol\space failed}%
  }
}{}

\hyperbaseurl{}
\hypersetup{extension = }
\hypersetup{
  % pdftex, % no effect
  pdftitle={\elbibl},
  % pdfauthor={Your name here},
  % pdfsubject={Your subject here},
  % pdfkeywords={keyword1, keyword2},
  bookmarksnumbered=true,
  bookmarksopen=true,
  bookmarksopenlevel=1,
  pdfstartview=Fit,
  % linktocpage=true, % toc, link only on page no
  pdfpagemode=UseOutlines,    % pdf toc
  % pdfpagelayout=TwoPageRight,
  citebordercolor=0.75 0.75 0.75,
  linkbordercolor=0.75 0.75 0.75,
  urlbordercolor=0.75 0.75 0.75,
  colorlinks=true,
  allcolors=black,
}
\usepackage{bookmark} % after hyperref





% generic typo commands
\newcommand{\astermono}{\medskip\centerline{\color{rubric}\large\selectfont{\syms ✻}}\medskip\par}%
\newcommand{\astertri}{\medskip\par\centerline{\color{rubric}\large\selectfont{\syms ✻\,✻\,✻}}\medskip\par}%
\newcommand{\asterism}{\bigskip\par\noindent\parbox{\linewidth}{\centering\color{rubric}\large{\syms ✻}\\{\syms ✻}\hskip 0.75em{\syms ✻}}\bigskip\par}%
\setlist{noitemsep,wide,leftmargin=*, labelindent=0pt} % labelindent=\parindent,leftmargin=*
\setlist[itemize]{label=—}
\renewcommand{\hrulefill}{%
  \leavevmode\leaders\hrule height 0.2pt\hfill\kern\z@}

% General typo
\DeclareTextFontCommand{\textlarge}{\large}
\DeclareTextFontCommand{\textsmall}{\small}


% commands, inlines
\newcommand\abbr{}
\newcommand{\autour}[1]{\tikz[baseline=(X.base)]\node [draw=rubric,thin,rectangle,inner sep=1.5pt, rounded corners=3pt] (X) {#1};}
\newcommand\corr{}
\newcommand{\ed}[1]{ {\color{silver}\sffamily\footnotesize (#1)} } % <milestone ed="1688"/>
\newcommand\expan{}
\newcommand\gap{}
\renewcommand{\LettrineFontHook}{\color{rubric}\mdseries\ttfamily}
\newcommand{\initial}[2]{\lettrine[lines=2, loversize=0.3, lhang=0.3]{#1}{#2}}
\newcommand{\initialiv}[2]{%
  \let\oldLFH\LettrineFontHook
  \renewcommand{\LettrineFontHook}{\color{rubric}\ttfamily}
  \lettrine[lines=4, loversize=0.2, lhang=0.2]{#1}{#2}
  \let\LettrineFontHook\oldLFH
}
\newcommand{\labelchar}[1]{{\color{rubric}\bf #1}}
\newcommand{\milestone}[1]{\autour{\footnotesize\color{rubric} #1}} % <milestone n="4"/>
\newcommand\orig{}
\newcommand\orgName{}
\newcommand\persName{}
\newcommand\name{}
\newcommand\placeName{}
\newcommand{\pn}[1]{\noindent\sffamily\textbf{#1.} } % <p n="3"/>
\newcommand\reg{}
% \newcommand\ref{} % already defined
\newcommand\sic{}

% commands, blocks
\newcommand{\byline}[1]{\bigskip{\RaggedLeft{#1}\par}\bigskip}
\newcommand{\bibl}[1]{{\footnotesize\RaggedLeft{#1}\par}}
\newcommand{\dateline}[1]{\medskip{\RaggedLeft{#1}\par}\bigskip}
\newcommand{\salute}[1]{\bigskip{#1}\par\medskip}

% environments for blocks (some may become commands)
\newenvironment{borderbox}{}{} % framing content
\newenvironment{citbibl}{\ifvmode\hfill\fi}{\ifvmode\par\fi }
\newenvironment{docAuthor}{\ifvmode\vskip4pt\fontsize{16pt}{18pt}\selectfont\fi\itshape}{\ifvmode\par\fi }
\newenvironment{docDate}{}{\ifvmode\par\fi }
\newenvironment{docImprint}{\vskip6pt}{\ifvmode\par\fi }
\newenvironment{docTitle}{\vskip6pt\bfseries\fontsize{18pt}{22pt}\selectfont}{\par }
\newenvironment{labelblock}
  {%
    \medskip
    \begin{center}
    \sffamily
    \bfseries
  }
  {%
    \end{center}
    \medskip
  }
\newenvironment{msHead}{\vskip6pt}{\par}
\newenvironment{msItem}{\vskip6pt}{\par}
\newenvironment{titlePart}{}{\par }


% environments for block containers
\newenvironment{argument}{\fontlight\parindent0pt}{\vskip1.5em}
\newenvironment{biblfree}{}{\ifvmode\par\fi }
\newenvironment{bibitemlist}[1]{%
  \list{\@biblabel{\@arabic\c@enumiv}}%
  {%
    \settowidth\labelwidth{\@biblabel{#1}}%
    \leftmargin\labelwidth
    \advance\leftmargin\labelsep
    \@openbib@code
    \usecounter{enumiv}%
    \let\p@enumiv\@empty
    \renewcommand\theenumiv{\@arabic\c@enumiv}%
  }
  \sloppy
  \clubpenalty4000
  \@clubpenalty \clubpenalty
  \widowpenalty4000%
  \sfcode`\.\@m
}%
{\def\@noitemerr
  {\@latex@warning{Empty `bibitemlist' environment}}%
\endlist}
\usepackage[%
  indentfirst=false,
  vskip=1em,
  noorphanfirst=true,
  noorphanafter=true,
  leftmargin=\parindent,
  rightmargin=0pt,
]{quoting}
\newenvironment{quoteblock}% may be used for ornaments
  {\begin{quoting}}
  {\end{quoting}}

% table () is preceded and finished by custom command
\newcommand{\tableopen}[1]{%
  \ifnum\strcmp{#1}{wide}=0{%
    \begin{center}
  }
  \else\ifnum\strcmp{#1}{long}=0{%
    \begin{center}
  }
  \else{%
    \begin{center}
  }
  \fi\fi
}
\newcommand{\tableclose}[1]{%
  \ifnum\strcmp{#1}{wide}=0{%
    \end{center}
  }
  \else\ifnum\strcmp{#1}{long}=0{%
    \end{center}
  }
  \else{%
    \end{center}
  }
  \fi\fi
}


% text structure
\newcommand\chapteropen{} % maybe useful for multicol settings
\newcommand\chapterclose{} % maybe useful for multicol settings
\setcounter{secnumdepth}{-2} % no counters for hierarchy titles
\setcounter{tocdepth}{5} % deep toc
\markright{\@title} % ???
\markboth{\@title}{\@author} % ???
\renewcommand\tableofcontents{\@starttoc{toc}}

% orphans and widows
\clubpenalty=9996
\widowpenalty=9999
\brokenpenalty=4991
\predisplaypenalty=10000
\postdisplaypenalty=1549
\displaywidowpenalty=1602
\hyphenpenalty=400
% Copied from Rahtz but not understood
\def\@pnumwidth{1.55em}
\def\@tocrmarg {2.55em}
\def\@dotsep{4.5}
\emergencystretch 3em
\hbadness=4000
\pretolerance=750
\tolerance=2000
\vbadness=4000
\def\Gin@extensions{.pdf,.png,.jpg,.mps,.tif}
% \renewcommand{\@cite}[1]{#1} % biblio


\makeatother % /@@@>
%%%%%%%%%%%%%%
% </TEI> end %
%%%%%%%%%%%%%%
